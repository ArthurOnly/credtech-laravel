function inputFilesToFormData(e){var a=new FormData;return $(`${e} input,select`).each((function(){const e=$(this).attr("name");var t="";"file"==$(this).attr("type")&&(t=$(this).get(0).files[0],a.append(e,t))})),a}function verifyBlanks(e){var a=!1;return $(`${e} input[require],select[require]`).each((function(){""==$(this).val()||null==$(this).val()?(toggleErrorNode($(this),!0),a=!0):toggleErrorNode($(this),!1)})),a}function verifyFields(e){return $(`${e} input,select`).each((function(){const e=$(this).attr("name"),a=$(this).val();let t;switch(e){case"name":t=!correctName(a),toggleErrorNode($(this),t);break;case"name":t=!correctEmail(a),toggleErrorNode($(this),t);break;case"loan_value":t=!correctLoanVale(a),toggleErrorNode($(this),t,"Valor mÃ­nimo R$ 100,00");break;case"cep":!async function(){t=await!correctCEP(a),toggleErrorNode($(this),t)}();break;case"CPF":t=!correctCPF(a),toggleErrorNode($(this),t)}})),!1}function handleUploadFields(){document.querySelectorAll('input[type="file"]').forEach((e=>{const a=document.querySelector(`label[for='${e.getAttribute("id")}'] spam`);e.addEventListener("change",(e=>{a.innerHTML=e.target.value.split(/(\\|\/)/g).pop()}))}))}function handleCheckboxFields(){document.querySelectorAll("div.checkbox").forEach((e=>{const a=e.querySelector("input");a.addEventListener("change",(()=>{a.checked?(e.classList.add("active"),e.parentNode.classList.remove("error")):(e.classList.remove("active"),e.parentNode.classList.add("error"))}))}))}function addMaksInFields(){$('input[name="celphone"]').each((function(){$(this).mask("(00) 00000-0000")}));$('input[name="value"]').each((function(){$(this).mask("000.000.000.000.000,00",{reverse:!0})}));$('input[name="cpf"]').each((function(){$(this).mask("000.000.000-00")}));$('input[name="cnpj"]').each((function(){$(this).mask("00.000.000/0000-00")}));$('input[name="cpf_cnpj"]').each((function(){var e={onKeyPress:function(e,a,t,c){var i=["000.000.000-000","00.000.000/0000-00"],n=e.length<15?i[0]:i[1];$('input[name="cpf_cnpj"]').mask(n,c)}};$(this).mask("000.000.000-000",e)}))}function toggleErrorNode(e,a,t){const c=e.parent();a?(c.addClass("error"),t&&c.find(".error-label p").text(t)):c.removeClass("error")}function correctName(e){return!(null==e||e.lenght<2)}function correctEmail(e){return!(null==e||e.lenght<4||!e.contains("@")||!e.contains("."))}function correctLoanVale(e){return null!=e&&(e=e.replaceAll(".","")),null!=e&&(e=e.replace(",",".")),!((e=Number(e))<100)}async function correctCEP(e){let a=e.replace("-","");a=a||"00000000";return!(await(await fetch(`http://viacep.com.br/ws/${a}/json/`)).json()).erro}function correctCPF(e){var a,t;if(a=0,"00000000000"==(e=(e=e.replaceAll(".","")).replace("-","")))return!1;for(i=1;i<=9;i++)a+=parseInt(e.substring(i-1,i))*(11-i);if(10!=(t=10*a%11)&&11!=t||(t=0),t!=parseInt(e.substring(9,10)))return!1;for(a=0,i=1;i<=10;i++)a+=parseInt(e.substring(i-1,i))*(12-i);return 10!=(t=10*a%11)&&11!=t||(t=0),t==parseInt(e.substring(10,11))}handleUploadFields(),handleCheckboxFields(),addMaksInFields();var strCPF="12345678909";const formPhysical='form[name="physical-person-form"]',physicalCpf=$(`${formPhysical} input[name="cpf"]`),physicalMoney=$(`${formPhysical} input[name='loan_value']`),physicalMonthly_income=$(`${formPhysical} input[name='monthly_income']`),physicalCep=$(`${formPhysical} input[name='cep']`),physicalCelphone=$(`${formPhysical} input[name='celphone']`);$(document).ready((function(){physicalCpf.mask("000.000.000-00"),physicalCep.mask("00000-000"),physicalCelphone.mask("(00) 00000-0000"),physicalMoney.mask("000.000,00",{reverse:!0}),physicalMonthly_income.mask("000.000.000,00",{reverse:!0})}));const blackOverlay=$(".black-overlay"),loanPopup=$(".loan-popup"),loanPopupCloser=$(".loan-popup-container > i");console.log(loanPopupCloser),loanPopupCloser.click((function(){blackOverlay.removeClass("active"),loanPopup.removeClass("active")})),$(formPhysical).submit((async e=>{e.preventDefault();const a=document.querySelector(`${formPhysical} #accept_data`);if(!a.checked)return void a.parentNode.parentNode.classList.add("error");var t=!1;if(verifyBlanks(formPhysical)&&(t=!0),verifyFields(formPhysical)&&(t=!0),t)return;blackOverlay.addClass("active"),loanPopup.addClass("active");const c=new FormData(document.querySelector(formPhysical));c.delete("accept_data");await fetch("http://localhost:8000/api/loan",{body:c,method:"post"})}));const selectSection=$(".select-type-container"),selectPhysical=$('button[name="select-pysical"]'),selectJuridical=$('button[name="select-juridical"]'),returnSelection=$(".return-to-select"),physicalSection=$("section.physical-person form"),physicalSectionHeader=$("section.physical-person .header"),juridicalSection=$("section.juridical-person form"),juridicalSectionHeader=$("section.juridical-person .header");returnSelection.each((function(){$(this).click((()=>{selectSection.addClass("active nav-margin"),juridicalSection.removeClass("active"),juridicalSectionHeader.removeClass("active nav-margin"),physicalSection.removeClass("active"),physicalSectionHeader.removeClass("active nav-margin")}))})),selectPhysical.click((()=>{selectSection.removeClass("active nav-margin"),physicalSection.addClass("active"),physicalSectionHeader.addClass("active nav-margin"),juridicalSectionHeader.removeClass("active nav-margin"),juridicalSection.removeClass("active")})),selectJuridical.click((()=>{selectSection.removeClass("active nav-margin"),juridicalSection.addClass("active"),juridicalSectionHeader.addClass("active nav-margin"),physicalSection.removeClass("active"),physicalSectionHeader.removeClass("active nav-margin")}));
